---
import BaseLayout from '../layouts/BaseLayout.astro';
import RecipeCard from '../components/RecipeCard.astro';
import ArticlePreview from '../components/ArticlePreview.astro';
import { getPostsByCategory } from '../lib/graphql';

const featuredRecipes = await getPostsByCategory('Recipes');
const featuredScienceArticles = await getPostsByCategory('Science');

// Limit to 3 featured items for now
const recipesToShow = featuredRecipes.slice(0, 3);
const scienceArticlesToShow = featuredScienceArticles.slice(0, 3);
---

<BaseLayout>
  <div class="text-center mb-12">
    <h1 class="text-5xl font-extrabold text-gray-900 leading-tight">Welcome to KetoHouse</h1>
    <p class="mt-4 text-xl text-gray-600">Your ultimate guide to the ketogenic lifestyle.</p>
  </div>

  <section class="mb-12">
    <h2 class="text-3xl font-bold text-gray-800 mb-6">Featured Recipes</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {recipesToShow.length > 0 ? (
        recipesToShow.map(recipe => <RecipeCard recipe={recipe} />)
      ) : (
        <p class="col-span-full text-center text-gray-500">No featured recipes available yet.</p>
      )}
    </div>
  </section>

  <section>
    <h2 class="text-3xl font-bold text-gray-800 mb-6">Latest Science Articles</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {scienceArticlesToShow.length > 0 ? (
        scienceArticlesToShow.map(article => <ArticlePreview article={article} />)
      ) : (
        <p class="col-span-full text-center text-gray-500">No science articles available yet.</p>
      )}
    </div>
  </section>
</BaseLayout>
